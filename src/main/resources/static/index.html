<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <main>
        <div class="container">
            <div class="img__container">
                <img src="" alt="">
            </div>
            <div class="form__container">
                <form class="form" action="" method="get">
                    <h1>LOGIN</h1>
                    <label for="usuario">Correo Electrónico:</label>
                    <input type="email" id="usuario" required>
                    <label for="contrasena">Contraseña:</label>
                    <input type="password" id="contrasena" required>
                    <a class="registrarse" href="#">Registrarse</a>
                    <input class="form__button" type="submit" value="Iniciar Sesión">
                </form>
            </div>
        </div>
    </main>
    <script>
        document.querySelector('.form').addEventListener('submit', function(e) {
            e.preventDefault();
            const correo = document.getElementById('usuario').value.trim();

            // Lógica de roles simple (como la tenías)
            if (correo.endsWith("@empresa.admin.pe")) {
                // Es un admin/supervisor, busquemos sus datos
                fetch(`http://localhost:8085/api/supervisores/correo/${correo}`)
                    .then(res => {
                        if (!res.ok) throw new Error('Supervisor no encontrado');
                        return res.json();
                    })
                    .then(supervisor => {
                        // --- ¡ÉXITO! Guardamos los datos del supervisor ---
                        sessionStorage.setItem("supervisorId", supervisor.idSupervisor);
                        sessionStorage.setItem("supervisorNombre", supervisor.nombre);

                        // Redirigir al portal de admin
                        window.location.href = "portal-admin.html";
                    })
                    .catch(err => {
                        console.error(err);
                        alert("Error: Supervisor no encontrado o el servidor falló.");
                    });

            } else if (correo.endsWith("@empleado.pe")) {
                // Lógica para empleados (si la tienes)
                // (Aquí podrías guardar el id del empleado)
                window.location.href = "dashboard.html";
            } else {
                alert("Correo no reconocido");
            }
        });
    </script>
</body>
</html>